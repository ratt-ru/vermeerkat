---
general:
    solr-url: "http://192.168.1.50:8983/solr/kat_core"
    msdir : 'msdir'
    input : 'input'
    output : 'output'
    fov : 1.5
    sampling : 0.1 # PSF sampling (<1)
    prefix : 'vermeerkat-pipeline' # change me, please!

h5toms:
    full_pol: true

rfimask:
    rfi-mask-file: "rfi_mask.pickle"

autoflag:
    column: "DATA"
    strategy-file: "29Dec2016_firstpass_strategy.rfis"


flag_userflags:
     mode: "manual"
     field: null
     antenna: null
     scan: null
     timerange: null
     spw: null
     autocorr: false

flag_bandstart:
    mode: "manual"
    field: ""
    spw: "0:0~110"
    autocorr: false

flag_bandend:
    mode: "manual"
    field: ""
    spw: "0:3840~4095"
    autocorr: false

flag_autocorrs:
    mode: "manual"
    field: ""
    spw: "0:0~4095"
    autocorr: true # flag only the autocorrs

casa_fixvis:
  reuse: false

setjy_manual:
    standard: "manual"
    usescratch: false
    scalebychan: true
    spw: ""

setjy_auto:
    standard: "Perley-Butler 2010"

phase0:
    caltable: ""
    field: ""
    refant: ""
    calmode: "p"
    solint: ""
    solnorm: true
    minsnr: 3.0

bandpass:
    caltable: ""
    field: ""
    spw: ""
    refant: ""
    combine: "scan"
    solint: ""
    solnorm: true
    bandtype: "B"
    minblperant: 1
    minsnr: 3.0
    gaintable: []
    interp: ["nearest", "nearest"]

delaycal:
    field: ""
    gaintype: "K"
    solint: inf # not sure if this is optimal
    minsnr: 5.0
    refant: 0
    caltable: ""
    calmode: "p"

gaincal:
    caltable: ""
    field:   ""
    spw: ""
    solint:  ""
    refant: ""
    gaintype: "G"
    calmode: "ap"
    solnorm:  false
    gaintable: []
    interp:   ["linear", "linear", "nearest"]

fluxscale:
    caltable: ""
    fluxtable: ""
    reference: ""
    transfer: ""
    incremental: false

applycal:
    field: ""
    gaintable: []
    gainfield: []
    spwmap: [[], [], []]
    parang: true
    interp: ["linear", "linear", "nearest", "linear"]

autoflag_corrected_vis:
    column: "CORRECTED_DATA"
    strategy-file: "06Jan2017_secondpass_strategy.rfis"

flag_baseline_phases:
    task: "flag_excessive_delay_error"
    data_column: "DATA"
    cal_field: ""
    valid_phase_range: "-15.0~15.0"
    max_invalid_datapoints: 65.0 # % of all unflagged data per channel
    nrows_chunk: 100000
    simulate: false

plot_ampuvdist:
    xaxis: "uvdist"
    yaxis: "amplitude"
    xdatacolumn: "corrected"
    ydatacolumn: "corrected"
    field: ""
    iteraxis: "corr"
    avgchannel: "15"
    avgtime: "15"
    coloraxis: "channel"
    expformat: "png"
    exprange: "all"
    plotfile: ""

plot_phaseuvdist:
    xaxis: "uvdist"
    yaxis: "phase"
    xdatacolumn: "corrected"
    ydatacolumn: "corrected"
    field: ""
    iteraxis: "corr"
    avgchannel: "15"
    avgtime: "15"
    coloraxis: "channel"
    expformat: "png"
    exprange: "all"
    plotfile: ""

plot_phaseball:
    xaxis: "amplitude"
    yaxis: "phase"
    xdatacolumn: "corrected"
    ydatacolumn: "corrected"
    field: ""
    iteraxis: "corr"
    avgchannel: "15"
    avgtime: "15"
    coloraxis: "baseline"
    expformat: "png"
    exprange: "all"
    plotfile: ""

plot_amp_freq:
    xaxis: "frequency"
    yaxis: "amplitude"
    xdatacolumn: "corrected"
    ydatacolumn: "corrected"
    field: ""
    iteraxis: "corr"
    avgchannel: "0"
    avgtime: "0"
    coloraxis: "baseline"
    expformat: "png"
    exprange: "all"
    plotfile: ""

plot_phase_time:
    xaxis: "time"
    yaxis: "phase"
    xdatacolumn: "corrected"
    ydatacolumn: "corrected"
    field: ""
    iteraxis: "corr"
    avgchannel: "0"
    avgtime: "0"
    coloraxis: "baseline"
    expformat: "png"
    exprange: "all"
    plotfile: ""

plot_phase_freq:
    xaxis: "frequency"
    yaxis: "phase"
    xdatacolumn: "corrected"
    ydatacolumn: "corrected"
    field: ""
    iteraxis: "corr"
    avgchannel: "0"
    avgtime: "0"
    coloraxis: "baseline"
    expformat: "png"
    exprange: "all"
    plotfile: ""


wsclean_image:
    column: "CORRECTED_DATA"
    weight: "briggs"
    robust: 0
    npix: 0.0
    cellsize: 0.0
    clean_iterations: 1000
    mgain: 0.9
    channelsout: 0
    joinchannels: true
    field: ""
    name: ""

wsclean_bandpass:
    column: "CORRECTED_DATA"
    weight: "briggs"
    robust: 0
    npix: 0
    cellsize: 0
    clean_iterations: 10000
    mgain: 0.9
    channelsout: 0
    joinchannels: true
    field: ""
    name: ""

wsclean_gain:
    column: "CORRECTED_DATA"
    weight: "briggs"
    robust: 0
    npix: 0
    cellsize: 0
    clean_iterations: 10000
    mgain: 0.9
    channelsout: 0
    joinchannels: true
    field: ""
    name: ""

move_corrdata_to_data:
    command: "copycol"
    fromcol: "CORRECTED_DATA"
    tocol: "DATA"

flagset_saveas_legacy:
    flagged_any: "legacy+L"
    flag: "legacy"

source_find:
    pybdsm: true
    thresh_pix: 20
    thresh_isl: 10

specfit:
  make_spi: true # Make SPI map
  tol: [-4, 4]   # Anything above this spi is highly unlikely
  spi_image: ""  # Don't have an alpha map
  add_spi: true
  skymodel: ""
  freq0: 0
  sigma: 20

selfcal:
  reset: "all" # Reset all existing gains
  label: "cal0"
  ncpu: 16
  column: "DATA"
  output: "CORR_RES"
  gjones: true
  gjones_intervals: []
  ddjones_smoothing: 1
  ejones: false
  beam_files_pattern: ""
  beam_l_axis: ""
  beam_m_axis: ""
  gjones_ampl_clipping: true
  gjones_ampl_clipping_low: 0.2
  gjones_ampl_clipping_high: 2
  args: ["stefcal_gain.delta=1e-6"]

wsclean_selfcal:
    "column"            : 'CORRECTED_DATA'
    "weight"            : 'briggs'
    "robust"            : 0
    "npix"              : 0
    "cellsize"          : 0
    "clean_iterations"  : 10000
    "mgain"             : 0.9
    "channelsout"       : 0
    "joinchannels"      : true
    "field"             : ""

cleanmask:
  sigma: 20
  iters: 10
  kernel: 13

wsclean_v_residue:
    "column"            : 'CORRECTED_DATA'
    "weight"            : 'briggs'
    "robust"            : 0
    "npix"              : 0
    "cellsize"          : 0
    "clean_iterations"  : 10000
    "mgain"             : 0.9
    "channelsout"       : 0
    "joinchannels"      : true
    "field"             : ""
    "pol"               : "V"
